module.exports=[37235,e=>{"use strict";let t;var r,n=e.i(47909),a=e.i(74017),i=e.i(96250),s=e.i(59756),o=e.i(61916),c=e.i(74677),u=e.i(69741),l=e.i(16795),d=e.i(87718),p=e.i(95169),h=e.i(47587),f=e.i(66012),m=e.i(70101),g=e.i(26937),w=e.i(10372),y=e.i(93695);e.i(52474);var v=e.i(220);function E(e){return e[0]??{}}function I(e){return Array.isArray(e)?e:null==e?[]:[e]}let x="orpc";class R extends Error{constructor(...e){super(...e),this.name="AbortError"}}function b(){return globalThis["__@orpc/shared@1.13.5/otel/config__"]}function S(e,t={},r){let n=b()?.tracer;return n?.startSpan(e,t,r)}function O(e,t,r={}){if(!e)return;let n=function(e){if(e instanceof Error){let t={message:e.message,name:e.name,stack:e.stack};return"code"in e&&("string"==typeof e.code||"number"==typeof e.code)&&(t.code=e.code),t}return{message:String(e)}}(t);e.recordException(n),r.signal?.aborted&&r.signal.reason===t||e.setStatus({code:2,message:n.message})}async function T({name:e,context:t,...r},n){let a=b()?.tracer;if(!a)return n();let i=async e=>{try{return await n(e)}catch(t){throw O(e,t,r),t}finally{e.end()}};return t?a.startActiveSpan(e,r,t,i):a.startActiveSpan(e,r,i)}async function _(e,t){let r=b();if(!e||!r)return t();let n=r.trace.setSpan(r.context.active(),e);return r.context.with(n,t)}function A(e){return!!e&&"object"==typeof e&&"next"in e&&"function"==typeof e.next&&Symbol.asyncIterator in e&&"function"==typeof e[Symbol.asyncIterator]}let C=Symbol.for("asyncDispose"),j=Symbol.asyncDispose??C;class N{#e=!1;#t=!1;#r;#n;constructor(e,t){this.#r=t,this.#n=function(e){let t=Promise.resolve();return(...r)=>t=t.catch(()=>{}).then(()=>e(...r))}(async()=>{if(this.#e)return{done:!0,value:void 0};try{let t=await e();return t.done&&(this.#e=!0),t}catch(e){throw this.#e=!0,e}finally{this.#e&&!this.#t&&(this.#t=!0,await this.#r("next"))}})}next(){return this.#n()}async return(e){return this.#e=!0,this.#t||(this.#t=!0,await this.#r("return")),{done:!0,value:e}}async throw(e){throw this.#e=!0,this.#t||(this.#t=!0,await this.#r("throw")),e}async [j](){this.#e=!0,this.#t||(this.#t=!0,await this.#r("dispose"))}[Symbol.asyncIterator](){return this}}function U({name:e,...t},r){let n;return new N(async()=>{n??=S(e);try{let e=await _(n,()=>r.next());return n?.addEvent(e.done?"completed":"yielded"),e}catch(e){throw O(n,e,t),e}},async e=>{try{"next"!==e&&await _(n,()=>r.return?.())}catch(e){throw O(n,e,t),e}finally{n?.end()}})}function z(e,t,r){let n=(t,a)=>{let i=e[a];return i?i({...t,next:(e=t)=>n(e,a+1)}):r(t)};return n(t,0)}function P(e){if(e)return JSON.parse(e)}function D(e){return JSON.stringify(e)}function M(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||!t||!t.constructor}function V(e){return!!e&&("object"==typeof e||"function"==typeof e)}let L=((t=function(){}).prototype=Object.create(null),Object.freeze(t.prototype),t);function $(e,...t){return"function"==typeof e?e(...t):e}let k={BAD_REQUEST:{status:400,message:"Bad Request"},UNAUTHORIZED:{status:401,message:"Unauthorized"},FORBIDDEN:{status:403,message:"Forbidden"},NOT_FOUND:{status:404,message:"Not Found"},METHOD_NOT_SUPPORTED:{status:405,message:"Method Not Supported"},NOT_ACCEPTABLE:{status:406,message:"Not Acceptable"},TIMEOUT:{status:408,message:"Request Timeout"},CONFLICT:{status:409,message:"Conflict"},PRECONDITION_FAILED:{status:412,message:"Precondition Failed"},PAYLOAD_TOO_LARGE:{status:413,message:"Payload Too Large"},UNSUPPORTED_MEDIA_TYPE:{status:415,message:"Unsupported Media Type"},UNPROCESSABLE_CONTENT:{status:422,message:"Unprocessable Content"},TOO_MANY_REQUESTS:{status:429,message:"Too Many Requests"},CLIENT_CLOSED_REQUEST:{status:499,message:"Client Closed Request"},INTERNAL_SERVER_ERROR:{status:500,message:"Internal Server Error"},NOT_IMPLEMENTED:{status:501,message:"Not Implemented"},BAD_GATEWAY:{status:502,message:"Bad Gateway"},SERVICE_UNAVAILABLE:{status:503,message:"Service Unavailable"},GATEWAY_TIMEOUT:{status:504,message:"Gateway Timeout"}};function q(e,t){return t??k[e]?.status??500}let F=Symbol.for("__@orpc/client@1.13.5/error/ORPC_ERROR_CONSTRUCTORS__");globalThis[F]??=new WeakSet;let H=globalThis[F];class B extends Error{defined;code;status;data;constructor(e,...t){const r=E(t);if(void 0!==r.status&&!W(r.status))throw Error("[ORPCError] Invalid error status code.");super(function(e,t){return t||k[e]?.message||e}(e,r.message),r),this.code=e,this.status=q(e,r.status),this.defined=r.defined??!1,this.data=r.data}toJSON(){return{defined:this.defined,code:this.code,status:this.status,message:this.message,data:this.data}}static[Symbol.hasInstance](e){if(H.has(this)){let t=V(e)?Object.getPrototypeOf(e)?.constructor:null;if(t&&H.has(t))return!0}return super[Symbol.hasInstance](e)}}function G(e){return e instanceof B?e:new B("INTERNAL_SERVER_ERROR",{message:"Internal server error",cause:e})}function W(e){return e<200||e>=400}H.add(B);class K extends TypeError{}class J extends TypeError{}class Y extends Error{data;constructor(e){super(e?.message??"An error event was received",e),this.data=e?.data}}class Q{constructor(e={}){this.options=e}incomplete="";feed(e){this.incomplete+=e;let t=this.incomplete.lastIndexOf("\n\n");if(-1===t)return;let r=this.incomplete.slice(0,t).split(/\n\n/);for(let e of(this.incomplete=this.incomplete.slice(t+2),r)){let t=function(e){let t=e.replace(/\n+$/,"").split(/\n/),r={data:void 0,event:void 0,id:void 0,retry:void 0,comments:[]};for(let e of t){let t=e.indexOf(":"),n=-1===t?e:e.slice(0,t),a=-1===t?"":e.slice(t+1).replace(/^\s/,"");if(0===t)r.comments.push(a);else if("data"===n)r.data??="",r.data+=`${a}
`;else if("event"===n)r.event=a;else if("id"===n)r.id=a;else if("retry"===n){let e=Number.parseInt(a);Number.isInteger(e)&&e>=0&&e.toString()===a&&(r.retry=e)}}return r.data=r.data?.replace(/\n$/,""),r}(`${e}

`);this.options.onEvent&&this.options.onEvent(t)}}end(){if(this.incomplete)throw new J("Event Iterator ended before complete")}}class X extends TransformStream{constructor(){let e;super({start(t){e=new Q({onEvent:e=>{t.enqueue(e)}})},transform(t){e.feed(t)},flush(){e.end()}})}}function Z(e){if(e.includes("\n"))throw new K("Event's id must not contain a newline character")}function ee(e){if(!Number.isInteger(e)||e<0)throw new K("Event's retry must be a integer and >= 0")}function et(e){if(e.includes("\n"))throw new K("Event's comment must not contain a newline character")}function er(e){let t="";if(t+=function(e){let t="";for(let r of e??[])et(r),t+=`: ${r}
`;return t}(e.comments),void 0!==e.event){if(e.event.includes("\n"))throw new K("Event's event must not contain a newline character");t+=`event: ${e.event}
`}return void 0!==e.retry&&(ee(e.retry),t+=`retry: ${e.retry}
`),void 0!==e.id&&(Z(e.id),t+=`id: ${e.id}
`),t+=function(e){let t=e?.split(/\n/)??[],r="";for(let e of t)r+=`data: ${e}
`;return r}(e.data),t+="\n"}let en=Symbol("ORPC_EVENT_SOURCE_META");function ea(e,t){if(void 0===t.id&&void 0===t.retry&&!t.comments?.length)return e;if(void 0!==t.id&&Z(t.id),void 0!==t.retry&&ee(t.retry),void 0!==t.comments)for(let e of t.comments)et(e);return new Proxy(e,{get:(e,r,n)=>r===en?t:Reflect.get(e,r,n)})}function ei(e){return V(e)?Reflect.get(e,en):void 0}class es extends N{hibernationCallback;constructor(e){super(async()=>{throw Error("Cannot iterate over hibernating iterator directly")},async e=>{if("next"!==e)throw Error("Cannot cleanup hibernating iterator directly")}),this.hibernationCallback=e}}function eo(e,t){let r=async e=>{let r=await t.error(e);if(r!==e){let t=ei(e);t&&V(r)&&(r=ea(r,t))}return r};return new N(async()=>{let{done:n,value:a}=await (async()=>{try{return await e.next()}catch(e){throw await r(e)}})(),i=await t.value(a,n);if(i!==a){let e=ei(a);e&&V(i)&&(i=ea(i,e))}return{done:n,value:i}},async()=>{try{await e.return?.()}catch(e){throw await r(e)}})}class ec extends Error{issues;data;constructor(e){super(e.message,e),this.issues=e.issues,this.data=e.data}}function eu(e,t){return{...e,...t}}async function el(e,t){let{code:r,status:n,message:a,data:i,cause:s,defined:o}=t,c=e?.[t.code];if(!c||q(t.code,c.status)!==t.status)return o?new B(r,{defined:!1,status:n,message:a,data:i,cause:s}):t;if(!c.data)return o?t:new B(r,{defined:!0,status:n,message:a,data:i,cause:s});let u=await c.data["~standard"].validate(t.data);return u.issues?o?new B(r,{defined:!1,status:n,message:a,data:i,cause:s}):t:new B(r,{defined:!0,status:n,message:a,data:u.value,cause:s})}class ed{"~orpc";constructor(e){if(e.route?.successStatus&&W(e.route.successStatus))throw Error("[ContractProcedure] Invalid successStatus.");if(Object.values(e.errorMap).some(e=>e&&e.status&&!W(e.status)))throw Error("[ContractProcedure] Invalid error status code.");this["~orpc"]=e}}function ep(e){return e instanceof ed||("object"==typeof e||"function"==typeof e)&&null!==e&&"~orpc"in e&&"object"==typeof e["~orpc"]&&null!==e["~orpc"]&&"errorMap"in e["~orpc"]&&"route"in e["~orpc"]&&"meta"in e["~orpc"]}class eh{customSerializers;constructor(e={}){if(this.customSerializers=e.customJsonSerializers??[],this.customSerializers.length!==new Set(this.customSerializers.map(e=>e.type)).size)throw Error("Custom serializer type must be unique.")}serialize(e,t=[],r=[],n=[],a=[]){for(let i of this.customSerializers)if(i.condition(e)){let s=this.serialize(i.serialize(e),t,r,n,a);return r.push([i.type,...t]),s}if(e instanceof Blob)return n.push(t),a.push(e),[e,r,n,a];if("bigint"==typeof e)return r.push([0,...t]),[e.toString(),r,n,a];if(e instanceof Date)return(r.push([1,...t]),Number.isNaN(e.getTime()))?[null,r,n,a]:[e.toISOString(),r,n,a];if(Number.isNaN(e))return r.push([2,...t]),[null,r,n,a];if(e instanceof URL)return r.push([4,...t]),[e.toString(),r,n,a];if(e instanceof RegExp)return r.push([5,...t]),[e.toString(),r,n,a];if(e instanceof Set){let i=this.serialize(Array.from(e),t,r,n,a);return r.push([6,...t]),i}if(e instanceof Map){let i=this.serialize(Array.from(e.entries()),t,r,n,a);return r.push([7,...t]),i}if(Array.isArray(e))return[e.map((e,i)=>void 0===e?(r.push([3,...t,i]),e):this.serialize(e,[...t,i],r,n,a)[0]),r,n,a];if(M(e)){let i={};for(let s in e)("toJSON"!==s||"function"!=typeof e[s])&&(i[s]=this.serialize(e[s],[...t,s],r,n,a)[0]);return[i,r,n,a]}return[e,r,n,a]}deserialize(e,t,r,n){let a={data:e};for(let e of(r&&n&&r.forEach((e,t)=>{let r=a,i="data";e.forEach(e=>{r=r[i],i=e}),r[i]=n(t)}),t)){let t=e[0],r=a,n="data";for(let t=1;t<e.length;t++)r=r[n],n=e[t];for(let e of this.customSerializers)if(e.type===t){r[n]=e.deserialize(r[n]);break}switch(t){case 0:r[n]=BigInt(r[n]);break;case 1:r[n]=new Date(r[n]??"Invalid Date");break;case 2:r[n]=NaN;break;case 3:r[n]=void 0;break;case 4:r[n]=new URL(r[n]);break;case 5:{let[,e,t]=r[n].match(/^\/(.*)\/([a-z]*)$/);r[n]=new RegExp(e,t);break}case 6:r[n]=new Set(r[n]);break;case 7:r[n]=new Map(r[n])}}return a.data}}function ef(e){return`/${e.map(encodeURIComponent).join("/")}`}class em{constructor(e){this.jsonSerializer=e}serialize(e){return A(e)?eo(e,{value:async e=>this.#a(e,!1),error:async e=>new Y({data:this.#a(G(e).toJSON(),!1),cause:e})}):this.#a(e,!0)}#a(e,t){let[r,n,a,i]=this.jsonSerializer.serialize(e),s=0===n.length?void 0:n;if(!t||0===i.length)return{json:r,meta:s};let o=new FormData;return o.set("data",D({json:r,meta:s,maps:a})),i.forEach((e,t)=>{o.set(t.toString(),e)}),o}deserialize(e){return A(e)?eo(e,{value:async e=>this.#i(e),error:async e=>{if(!(e instanceof Y))return e;let t=this.#i(e.data);return!function(e){if(!M(e))return!1;let t=["defined","code","status","message","data"];return!Object.keys(e).some(e=>!t.includes(e))&&"defined"in e&&"boolean"==typeof e.defined&&"code"in e&&"string"==typeof e.code&&"status"in e&&"number"==typeof e.status&&W(e.status)&&"message"in e&&"string"==typeof e.message}(t)?new Y({data:t,cause:e}):function(e,t={}){return new B(e.code,{...t,...e})}(t,{cause:e})}}):this.#i(e)}#i(e){if(void 0===e)return;if(!(e instanceof FormData))return this.jsonSerializer.deserialize(e.json,e.meta??[]);let t=JSON.parse(e.get("data"));return this.jsonSerializer.deserialize(t.json,t.meta??[],t.maps,t=>e.get(t.toString()))}}function eg(e,t){return{...e,...t}}function ew(e,t){return{...e,...t}}function ey(e,t){return e?`${e}${t}`:t}function ev(e,t){return e?[...e,...t]:t}function eE(e,t){var r,n,a,i;let s=e;return t.prefix&&(r=s,n=t.prefix,s=r.path?{...r,path:`${n}${r.path}`}:r),t.tags?.length&&(a=s,i=t.tags,s={...a,tags:[...i,...a.tags??[]]}),s}class eI extends ed{constructor(e){super(e),this["~orpc"].prefix=e.prefix,this["~orpc"].tags=e.tags}$meta(e){return new eI({...this["~orpc"],meta:e})}$route(e){return new eI({...this["~orpc"],route:e})}$input(e){return new eI({...this["~orpc"],inputSchema:e})}errors(e){return new eI({...this["~orpc"],errorMap:eu(this["~orpc"].errorMap,e)})}meta(e){return new eI({...this["~orpc"],meta:eg(this["~orpc"].meta,e)})}route(e){return new eI({...this["~orpc"],route:ew(this["~orpc"].route,e)})}input(e){return new eI({...this["~orpc"],inputSchema:e})}output(e){return new eI({...this["~orpc"],outputSchema:e})}prefix(e){return new eI({...this["~orpc"],prefix:ey(this["~orpc"].prefix,e)})}tag(...e){return new eI({...this["~orpc"],tags:ev(this["~orpc"].tags,e)})}router(e){return function e(t,r){if(ep(t))return new ed({...t["~orpc"],errorMap:eu(r.errorMap,t["~orpc"].errorMap),route:eE(t["~orpc"].route,r)});let n={};for(let a in t)n[a]=e(t[a],r);return n}(e,this["~orpc"])}}new eI({errorMap:{},route:{},meta:{}});let ex="POST";Symbol("ORPC_EVENT_ITERATOR_DETAILS");let eR=Symbol("ORPC_LAZY_SYMBOL");function eb(e,t={}){return{[eR]:{loader:e,meta:t}}}function eS(e){return("object"==typeof e||"function"==typeof e)&&null!==e&&eR in e}function eO(e){return eS(e)?e[eR].loader():Promise.resolve({default:e})}class eT{"~orpc";constructor(e){this["~orpc"]=e}}function e_(e){return e instanceof eT||ep(e)&&"middlewares"in e["~orpc"]&&"inputValidationIndex"in e["~orpc"]&&"outputValidationIndex"in e["~orpc"]&&"handler"in e["~orpc"]}function eA(e){return{output:e,context:{}}}function eC(e,...t){let r=E(t);return async(...[t,n])=>{var a,i;let s=I(r.path),{default:o}=await eO(e),c=n?.context??{},u=await $(r.context??{},c),l=new Proxy(a=o["~orpc"].errorMap,{get:(e,t)=>"string"!=typeof t?Reflect.get(e,t):(...e)=>{let r=E(e),n=a[t];return new B(t,{defined:!!n,status:n?.status,message:r.message??n?.message,data:r.data,cause:r.cause})}}),d=async e=>e instanceof B?await el(o["~orpc"].errorMap,e):e;try{let e=await T({name:"call_procedure",signal:n?.signal},e=>(e?.setAttribute("procedure.path",[...s]),z(I(r.interceptors),{context:u,input:t,errors:l,path:s,procedure:o,signal:n?.signal,lastEventId:n?.lastEventId},e=>eU(e.procedure,e))));if(A(e)){if(e instanceof es)return e;return i=eo(U({name:"consume_event_iterator_output",signal:n?.signal},e),{value:e=>e,error:e=>d(e)}),new Proxy("function"==typeof e?i:e,{get(t,r){let n=r in i?i:$(e),a=Reflect.get(n,r);return"function"==typeof a?a.bind(n):a},has:(t,r)=>Reflect.has(i,r)||Reflect.has($(e),r)})}return e}catch(e){throw await d(e)}}}async function ej(e,t){let r=e["~orpc"].inputSchema;return r?T({name:"validate_input"},async()=>{let e=await r["~standard"].validate(t);if(e.issues)throw new B("BAD_REQUEST",{message:"Input validation failed",data:{issues:e.issues},cause:new ec({message:"Input validation failed",issues:e.issues,data:t})});return e.value}):t}async function eN(e,t){let r=e["~orpc"].outputSchema;return r?T({name:"validate_output"},async()=>{let e=await r["~standard"].validate(t);if(e.issues)throw new B("INTERNAL_SERVER_ERROR",{message:"Output validation failed",cause:new ec({message:"Output validation failed",issues:e.issues,data:t})});return e.value}):t}async function eU(e,t){let r=e["~orpc"].middlewares,n=Math.min(Math.max(0,e["~orpc"].inputValidationIndex),r.length),a=Math.min(Math.max(0,e["~orpc"].outputValidationIndex),r.length),i=async(s,o,c)=>{let u=c;s===n&&(u=await ej(e,u));let l=r[s],d=l?await T({name:`middleware.${l.name}`,signal:t.signal},async e=>(e?.setAttribute("middleware.index",s),e?.setAttribute("middleware.name",l.name),(await l({...t,context:o,next:async(...[e])=>{let t=e?.context??{};return{output:await i(s+1,{...o,...t},u),context:t}}},u,eA)).output)):await T({name:"handler",signal:t.signal},()=>e["~orpc"].handler({...t,context:o,input:u}));return s===a?await eN(e,d):d};return i(0,t.context,t.input)}let ez=Symbol("ORPC_HIDDEN_ROUTER_CONTRACT");function eP(e,t){let r=e;for(let e=0;e<t.length;e++){let n=t[e];if(!r||e_(r))return;if(!eS(r)){r=r[n];continue}let a=r,i=t.slice(e);return eb(async()=>{let e=eP((await eO(a)).default,i);return eO(e)},a[eR].meta)}return r}function eD(e,t){if(eS(e)){let r=e[eR].meta,n=r?.prefix?ey(t.prefix,r?.prefix):t.prefix;return function e(t){return new Proxy(t,{get:(r,n)=>"string"!=typeof n?Reflect.get(r,n):e(eP(t,[n]))})}(eb(async()=>{let{default:r}=await eO(e);return eO(eD(r,t))},{...r,prefix:n}))}if(e_(e)){var r,n;let a=(r=t.middlewares,n=e["~orpc"].middlewares,({dedupeLeading:t.dedupeLeadingMiddlewares}).dedupeLeading&&function(e,t){if(t.length>e.length)return!1;for(let r=0;r<e.length&&void 0!==t[r];r++)if(e[r]!==t[r])return!1;return!0}(n,r)?n:[...r,...n]),i=a.length-e["~orpc"].middlewares.length;return new eT({...e["~orpc"],route:eE(e["~orpc"].route,t),errorMap:eu(t.errorMap,e["~orpc"].errorMap),middlewares:a,inputValidationIndex:e["~orpc"].inputValidationIndex+i,outputValidationIndex:e["~orpc"].outputValidationIndex+i})}let a={};for(let r in e)a[r]=eD(e[r],t);return a}let eM={initialInputValidationIndex:0,initialOutputValidationIndex:0,dedupeLeadingMiddlewares:!0};function eV(e,t){return void 0===t?eM[e]:t}function eL(e){let t=(...t)=>e(...t);return t.mapInput=t=>eL((r,n,...a)=>e(r,t(n),...a)),t.concat=(t,r)=>{let n=r?eL(t).mapInput(r):t;return eL((t,r,a,...i)=>e({...t,next:(...[e])=>n({...t,context:{...t.context,...e?.context},next:(...[r])=>t.next({context:{...e?.context,...r?.context}})},r,a,...i)},r,a,...i))},t}class e$ extends eT{errors(e){return new e$({...this["~orpc"],errorMap:eu(this["~orpc"].errorMap,e)})}meta(e){return new e$({...this["~orpc"],meta:eg(this["~orpc"].meta,e)})}route(e){return new e$({...this["~orpc"],route:ew(this["~orpc"].route,e)})}use(e,t){let r=t?eL(e).mapInput(t):e;return new e$({...this["~orpc"],middlewares:[...this["~orpc"].middlewares,r]})}callable(...e){return new Proxy(eC(this,...e),{get:(e,t)=>Reflect.has(this,t)?Reflect.get(this,t):Reflect.get(e,t),has:(e,t)=>Reflect.has(this,t)||Reflect.has(e,t)})}actionable(...e){var t;return new Proxy((t=eC(this,...e),async e=>{try{return[null,await t(e)]}catch(e){if(e instanceof Error&&"digest"in e&&"string"==typeof e.digest&&e.digest.startsWith("NEXT_")||e instanceof Response&&"options"in e&&M(e.options)||M(e)&&!0===e.isNotFound)throw e;return[G(e).toJSON(),void 0]}}),{get:(e,t)=>Reflect.has(this,t)?Reflect.get(this,t):Reflect.get(e,t),has:(e,t)=>Reflect.has(this,t)||Reflect.has(e,t)})}}class ek{"~orpc";constructor(e){this["~orpc"]=e}$config(e){let t=this["~orpc"].inputValidationIndex-eV("initialInputValidationIndex",this["~orpc"].config.initialInputValidationIndex),r=this["~orpc"].outputValidationIndex-eV("initialOutputValidationIndex",this["~orpc"].config.initialOutputValidationIndex);return new ek({...this["~orpc"],config:e,dedupeLeadingMiddlewares:eV("dedupeLeadingMiddlewares",e.dedupeLeadingMiddlewares),inputValidationIndex:eV("initialInputValidationIndex",e.initialInputValidationIndex)+t,outputValidationIndex:eV("initialOutputValidationIndex",e.initialOutputValidationIndex)+r})}$context(){return new ek({...this["~orpc"],middlewares:[],inputValidationIndex:eV("initialInputValidationIndex",this["~orpc"].config.initialInputValidationIndex),outputValidationIndex:eV("initialOutputValidationIndex",this["~orpc"].config.initialOutputValidationIndex)})}$meta(e){return new ek({...this["~orpc"],meta:e})}$route(e){return new ek({...this["~orpc"],route:e})}$input(e){return new ek({...this["~orpc"],inputSchema:e})}middleware(e){return eL(e)}errors(e){return new ek({...this["~orpc"],errorMap:eu(this["~orpc"].errorMap,e)})}use(e,t){let r=t?eL(e).mapInput(t):e;return new ek({...this["~orpc"],middlewares:[...this["~orpc"].middlewares,r]})}meta(e){return new ek({...this["~orpc"],meta:eg(this["~orpc"].meta,e)})}route(e){return new ek({...this["~orpc"],route:ew(this["~orpc"].route,e)})}input(e){return new ek({...this["~orpc"],inputSchema:e,inputValidationIndex:eV("initialInputValidationIndex",this["~orpc"].config.initialInputValidationIndex)+this["~orpc"].middlewares.length})}output(e){return new ek({...this["~orpc"],outputSchema:e,outputValidationIndex:eV("initialOutputValidationIndex",this["~orpc"].config.initialOutputValidationIndex)+this["~orpc"].middlewares.length})}handler(e){return new e$({...this["~orpc"],handler:e})}prefix(e){return new ek({...this["~orpc"],prefix:ey(this["~orpc"].prefix,e)})}tag(...e){return new ek({...this["~orpc"],tags:ev(this["~orpc"].tags,e)})}router(e){return eD(e,this["~orpc"])}lazy(e){return eD(eb(e),this["~orpc"])}}let eq=new ek({config:{},route:{},meta:{},errorMap:{},inputValidationIndex:eV("initialInputValidationIndex"),outputValidationIndex:eV("initialOutputValidationIndex"),middlewares:[],dedupeLeadingMiddlewares:!0});class eF{plugins;constructor(e=[]){this.plugins=[...e].sort((e,t)=>(e.order??0)-(t.order??0))}init(e,t){for(let r of this.plugins)r.init?.(e,t)}}class eH{constructor(e,t,r,n){this.matcher=t,this.codec=r,new eF(n.plugins).init(n,e),this.interceptors=I(n.interceptors),this.clientInterceptors=I(n.clientInterceptors),this.rootInterceptors=I(n.rootInterceptors),this.matcher.init(e)}interceptors;clientInterceptors;rootInterceptors;async handle(e,t){let r=t.prefix?.replace(/\/$/,"")||void 0;return r&&!e.url.pathname.startsWith(`${r}/`)&&e.url.pathname!==r?{matched:!1,response:void 0}:z(this.rootInterceptors,{...t,request:e,prefix:r},async t=>T({name:`${e.method} ${e.url.pathname}`},async e=>{let r;try{return await z(this.interceptors,t,async({request:t,context:n,prefix:a})=>{var i;let s=t.method,o=t.url,c=a?o.pathname.replace(a,""):o.pathname,u=await T({name:"find_procedure"},()=>this.matcher.match(s,`/${c.replace(/^\/|\/$/g,"")}`));if(!u)return{matched:!1,response:void 0};e?.updateName(`${x}.${u.path.join("/")}`),e?.setAttribute("rpc.system",x),e?.setAttribute("rpc.method",u.path.join(".")),r="decode_input";let l=await T({name:"decode_input"},()=>this.codec.decode(t,u.params,u.procedure));r=void 0,A(l)&&(l=U({name:"consume_event_iterator_input",signal:t.signal},l));let d=eC(u.procedure,{context:n,path:u.path,interceptors:this.clientInterceptors});r="call_procedure";let p=await d(l,{signal:t.signal,lastEventId:(i=t.headers["last-event-id"],"string"==typeof i||void 0===i?i:0!==i.length?i.join(", "):void 0)});r=void 0;let h=this.codec.encode(p,u.procedure);return{matched:!0,response:h}})}catch(n){"call_procedure"!==r&&O(e,n);let t="decode_input"!==r||n instanceof B?G(n):new B("BAD_REQUEST",{message:"Malformed request. Ensure the request body is properly formatted and the 'Content-Type' header is set correctly.",cause:n});return{matched:!0,response:this.codec.encodeError(t)}}}))}}class eB{constructor(e){this.serializer=e}async decode(e,t,r){let n="GET"===e.method?P(e.url.searchParams.getAll("data").at(-1)):await e.body();return this.serializer.deserialize(n)}encode(e,t){return{status:200,headers:{},body:this.serializer.serialize(e)}}encodeError(e){return{status:e.status,headers:{},body:this.serializer.serialize(e.toJSON())}}}class eG{filter;tree=new L;pendingRouters=[];constructor(e={}){this.filter=e.filter??!0}init(e,t=[]){let r=function e(t,r,n=[]){let a=t.router,i=t.router[ez];if(void 0!==i&&(a=i),eS(a))n.push({router:a,path:t.path});else if(ep(a))r({contract:a,path:t.path});else for(let i in a)e({router:a[i],path:[...t.path,i]},r,n);return n}({router:e,path:t},t=>{if(!$(this.filter,t))return;let{path:r,contract:n}=t,a=ef(r);e_(n)?this.tree[a]={path:r,contract:n,procedure:n,router:e}:this.tree[a]={path:r,contract:n,procedure:void 0,router:e}});this.pendingRouters.push(...r.map(e=>({...e,httpPathPrefix:ef(e.path)})))}async match(e,t){if(this.pendingRouters.length){let e=[];for(let r of this.pendingRouters)if(t.startsWith(r.httpPathPrefix)){let{default:e}=await eO(r.router);this.init(e,r.path)}else e.push(r);this.pendingRouters=e}let r=this.tree[t];if(r){if(!r.procedure){var n;let{default:e}=await eO(eP(r.router,r.path));if(!e_(e))throw Error(`
          [Contract-First] Missing or invalid implementation for procedure at path: ${ef(r.path)}.
          Ensure that the procedure is correctly defined and matches the expected contract.
        `);n=r.contract,r.procedure=new eT({...e["~orpc"],errorMap:n["~orpc"].errorMap,route:n["~orpc"].route,meta:n["~orpc"].meta})}return{path:r.path,procedure:r.procedure}}}}class eW extends eH{constructor(e,t={}){const r=new em(new eh(t));super(e,new eG(t),new eB(r),t)}}let eK=Symbol("STRICT_GET_METHOD_PLUGIN_IS_GET_METHOD_CONTEXT");class eJ{error;order=7e6;constructor(e={}){this.error=e.error??new B("METHOD_NOT_SUPPORTED")}init(e){e.rootInterceptors??=[],e.clientInterceptors??=[],e.rootInterceptors.unshift(e=>{let t="GET"===e.request.method;return e.next({...e,context:{...e.context,[eK]:t}})}),e.clientInterceptors.unshift(e=>{var t;if("boolean"!=typeof e.context[eK])throw TypeError("[StrictGetMethodPlugin] strict GET method context has been corrupted or modified by another plugin or interceptor");let r=void 0===(t=e.procedure["~orpc"].route.method)?ex:t;if(e.context[eK]&&"GET"!==r)throw this.error;return e.next()})}}class eY extends eF{initRuntimeAdapter(e){for(let t of this.plugins)t.initRuntimeAdapter?.(e)}}class eQ{constructor(e,t={}){this.standardHandler=e,new eY(t.plugins).initRuntimeAdapter(t),this.adapterInterceptors=I(t.adapterInterceptors),this.toFetchResponseOptions=t}toFetchResponseOptions;adapterInterceptors;async handle(e,...t){var r;return z(this.adapterInterceptors,{...{...r=E(t),context:r.context??{}},request:e,toFetchResponseOptions:this.toFetchResponseOptions},async({request:e,toFetchResponseOptions:t,...r})=>{var n;let a,i={url:new URL(e.url),signal:e.signal,method:e.method,body:(n=()=>(function(e,t={}){return T({name:"parse_standard_body",signal:t.signal},async()=>{let r=e.headers.get("content-disposition");if("string"==typeof r){let t=function(e){let t=e.match(/filename\*=(UTF-8'')?([^;]*)/i);if(t&&"string"==typeof t[2]){var r=t[2];try{return decodeURIComponent(r)}catch{return r}}let n=e.match(/filename="((?:\\"|[^"])*)"/i);if(n&&"string"==typeof n[1])return n[1].replace(/\\"/g,'"')}(r)??"blob",n=await e.blob();return new File([n],t,{type:n.type})}let n=e.headers.get("content-type");if(!n||n.startsWith("application/json"))return P(await e.text());if(n.startsWith("multipart/form-data"))return await e.formData();if(n.startsWith("application/x-www-form-urlencoded"))return new URLSearchParams(await e.text());if(n.startsWith("text/event-stream"))return function(e,t={}){let r,n=e?.pipeThrough(new TextDecoderStream).pipeThrough(new X),a=n?.getReader(),i=!1;return new N(async()=>{r??=S("consume_event_iterator_stream");try{for(;;){if(void 0===a)return{done:!0,value:void 0};let{done:e,value:t}=await _(r,()=>a.read());if(e){if(i)throw new R("Stream was cancelled");return{done:!0,value:void 0}}switch(t.event){case"message":{let e=P(t.data);return V(e)&&(e=ea(e,t)),r?.addEvent("message"),{done:!1,value:e}}case"error":{let e=new Y({data:P(t.data)});throw e=ea(e,t),r?.addEvent("error"),e}case"done":{let e=P(t.data);return V(e)&&(e=ea(e,t)),r?.addEvent("done"),{done:!0,value:e}}default:r?.addEvent("maybe_keepalive")}}}catch(e){throw e instanceof Y||O(r,e,t),e}},async e=>{try{"next"!==e&&(i=!0,r?.addEvent("cancelled")),await _(r,()=>a?.cancel())}catch(e){throw O(r,e,t),e}finally{r?.end()}})}(e.body,t);if(n.startsWith("text/plain"))return await e.text();let a=await e.blob();return new File([a],"blob",{type:a.type})})})(e,{signal:e.signal}),()=>{if(a)return a.result;let e=n();return a={result:e},e}),get headers(){let t=function(e,t={}){return e.forEach((e,r)=>{Array.isArray(t[r])?t[r].push(e):void 0!==t[r]?t[r]=[t[r],e]:t[r]=e}),t}(e.headers);return Object.defineProperty(this,"headers",{value:t,writable:!0}),t},set headers(value){Object.defineProperty(this,"headers",{value,writable:!0})}},s=await this.standardHandler.handle(i,r);return s.matched?{matched:!0,response:function(e,t={}){let r=function(e,t=new Headers){for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(r,e);else void 0!==n&&t.append(r,n);return t}(e.headers);return new Response(function(e,t,r={}){let n=t.get("content-disposition");if(t.delete("content-type"),t.delete("content-disposition"),void 0!==e){if(e instanceof Blob){var a;let r,i;return t.set("content-type",e.type),t.set("content-length",e.size.toString()),t.set("content-disposition",n??(r=(a=e instanceof File?e.name:"blob").replace(/"/g,'\\"'),i=encodeURIComponent(a).replace(/['()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`).replace(/%(7C|60|5E)/g,(e,t)=>String.fromCharCode(Number.parseInt(t,16))),`inline; filename="${r}"; filename*=utf-8''${i}`)),e}return e instanceof FormData||e instanceof URLSearchParams?e:A(e)?(t.set("content-type","text/event-stream"),function(e,t={}){let r,n,a=t.eventIteratorKeepAliveEnabled??!0,i=t.eventIteratorKeepAliveInterval??5e3,s=t.eventIteratorKeepAliveComment??"",o=t.eventIteratorInitialCommentEnabled??!0,c=t.eventIteratorInitialComment??"",u=!1;return new ReadableStream({start(e){n=S("stream_event_iterator"),o&&e.enqueue(er({comments:[c]}))},async pull(t){try{a&&(r=setInterval(()=>{t.enqueue(er({comments:[s]})),n?.addEvent("keepalive")},i));let o=await _(n,()=>e.next());if(clearInterval(r),u)return;let c=ei(o.value);if(!o.done||void 0!==o.value||void 0!==c){let e=o.done?"done":"message";t.enqueue(er({...c,event:e,data:D(o.value)})),n?.addEvent(e)}o.done&&(t.close(),n?.end())}catch(e){if(clearInterval(r),u)return;e instanceof Y?(t.enqueue(er({...ei(e),event:"error",data:D(e.data)})),n?.addEvent("error"),t.close()):(O(n,e),t.error(e)),n?.end()}},async cancel(){try{u=!0,clearInterval(r),n?.addEvent("cancelled"),await _(n,()=>e.return?.())}catch(e){throw O(n,e),e}finally{n?.end()}}}).pipeThrough(new TextEncoderStream)}(e,r)):(t.set("content-type","application/json"),D(e))}}(e.body,r,t),{headers:r,status:e.status})}(s.response,t)}:s})}}var eX=e.i(27577),eZ=e.i(20153);async function e0({request:e}){var t;let r,n=await eX.auth.api.getSession({headers:e.headers}),a=!!n?.user?.email&&(t=n.user.email,!(r=(0,eZ.getServerEnv)().CMS_ALLOWED_EMAILS)||String(r).split(",").map(e=>e.trim().toLowerCase()).includes(t.toLowerCase()));return{session:n,isAdmin:a}}let e1=eq.$context(),e4=e1.middleware(async({context:e,next:t})=>{if(!e.session?.user)throw new B("UNAUTHORIZED");return t({context:{session:e.session}})}),e5=e1.middleware(async({context:e,next:t})=>{if(!e.session?.user)throw new B("UNAUTHORIZED");if(!e.isAdmin)throw new B("FORBIDDEN");return t({context:{session:e.session}})}),e2=e1.use(e4),e7=e1.use(e5);var e6=e.i(49129),e9=e.i(75225),e3=e.i(69719),e8=e.i(84501),te=e.i(15894);let tt=e3.z.string().min(1).regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/,"Slug must be URL-safe (lowercase letters, numbers, hyphens)"),tr=e3.z.object({slug:tt,title:e3.z.string().min(1),description:e3.z.string(),featuredImageUrl:e3.z.string().optional().nullable(),published:e3.z.boolean().optional(),imageUrls:e3.z.array(e3.z.string().min(1)).optional()}),tn=tr.partial().extend({id:e3.z.string().min(1)}),ta={list:e1.handler(async()=>await e8.db.select({id:te.project.id,slug:te.project.slug,title:te.project.title,description:te.project.description,featuredImageUrl:te.project.featuredImageUrl}).from(te.project).where((0,e9.eq)(te.project.published,!0)).orderBy((0,e6.desc)(te.project.updatedAt))),getBySlug:e1.input(e3.z.object({slug:e3.z.string().min(1)})).handler(async({input:e})=>{let[t]=await e8.db.select().from(te.project).where((0,e9.eq)(te.project.slug,e.slug)).limit(1);if(!t||!t.published)return null;let r=await e8.db.select({id:te.projectImage.id,url:te.projectImage.url,sortOrder:te.projectImage.sortOrder}).from(te.projectImage).where((0,e9.eq)(te.projectImage.projectId,t.id)).orderBy(te.projectImage.sortOrder);return{id:t.id,slug:t.slug,title:t.title,description:t.description,featuredImageUrl:t.featuredImageUrl,images:r}}),listAdmin:e7.handler(async()=>await e8.db.select({id:te.project.id,slug:te.project.slug,title:te.project.title,published:te.project.published,updatedAt:te.project.updatedAt}).from(te.project).orderBy((0,e6.desc)(te.project.updatedAt))),getById:e7.input(e3.z.object({id:e3.z.string().min(1)})).handler(async({input:e})=>{let[t]=await e8.db.select().from(te.project).where((0,e9.eq)(te.project.id,e.id)).limit(1);if(!t)return null;let r=await e8.db.select({id:te.projectImage.id,url:te.projectImage.url,sortOrder:te.projectImage.sortOrder}).from(te.projectImage).where((0,e9.eq)(te.projectImage.projectId,t.id)).orderBy(te.projectImage.sortOrder);return{...t,images:r}}),create:e7.input(tr).handler(async({input:e})=>{try{let[t]=await e8.db.select({id:te.project.id}).from(te.project).where((0,e9.eq)(te.project.slug,e.slug)).limit(1);if(t)throw new B("CONFLICT",{message:"A project with this slug already exists."});let r=crypto.randomUUID();await e8.db.insert(te.project).values({id:r,slug:e.slug,title:e.title,description:e.description??"",featuredImageUrl:e.featuredImageUrl??null,published:e.published??!1});let n=e.imageUrls??[];return n.length>0&&await e8.db.insert(te.projectImage).values(n.map((e,t)=>({id:crypto.randomUUID(),projectId:r,url:e,sortOrder:t}))),{id:r}}catch(e){throw new B("INTERNAL_SERVER_ERROR",{message:e instanceof Error?e.message:String(e)})}}),update:e7.input(tn).handler(async({input:e})=>{try{let{id:t,imageUrls:r,...n}=e;if(void 0!==n.slug){let[e]=await e8.db.select({id:te.project.id}).from(te.project).where((0,e9.eq)(te.project.slug,n.slug)).limit(1);if(e&&e.id!==t)throw new B("CONFLICT",{message:"A project with this slug already exists."})}let a={};return void 0!==n.slug&&(a.slug=n.slug),void 0!==n.title&&(a.title=n.title),void 0!==n.description&&(a.description=n.description),void 0!==n.featuredImageUrl&&(a.featuredImageUrl=n.featuredImageUrl),void 0!==n.published&&(a.published=n.published),Object.keys(a).length>0&&await e8.db.update(te.project).set(a).where((0,e9.eq)(te.project.id,t)),void 0!==r&&(await e8.db.delete(te.projectImage).where((0,e9.eq)(te.projectImage.projectId,t)),r.length>0&&await e8.db.insert(te.projectImage).values(r.map((e,r)=>({id:crypto.randomUUID(),projectId:t,url:e,sortOrder:r})))),{id:t}}catch(e){throw new B("INTERNAL_SERVER_ERROR",{message:e instanceof Error?e.message:String(e)})}}),delete:e7.input(e3.z.object({id:e3.z.string().min(1)})).handler(async({input:e})=>(await e8.db.delete(te.project).where((0,e9.eq)(te.project.id,e.id)),{ok:!0}))};var ti=e.i(76858);let ts={get:e1.input(e3.z.object({key:e3.z.string().min(1)})).handler(async({input:e})=>{let[t]=await e8.db.select().from(ti.siteSetting).where((0,e9.eq)(ti.siteSetting.key,e.key)).limit(1);return t?.value??null}),upsert:e7.input(e3.z.object({key:e3.z.string().min(1),value:e3.z.string()})).handler(async({input:e})=>(await e8.db.insert(ti.siteSetting).values({key:e.key,value:e.value}).onConflictDoUpdate({target:ti.siteSetting.key,set:{value:e.value}}),{ok:!0}))},to={healthCheck:e1.handler(()=>"OK"),privateData:e2.handler(({context:e})=>({message:"This is private",user:e.session?.user})),project:ta,setting:ts},tc=new class extends eQ{constructor(e,t={}){(t.strictGetMethodPluginEnabled??!0)&&(t.plugins??=[],t.plugins.push(new eJ)),super(new eW(e,t),t)}}(to,{interceptors:[(r=e=>{console.error(e)},async(e,...t)=>{try{return await e.next()}catch(n){throw await r(n,e,...t),n}})]});async function tu(e){try{let t=await e0({request:e}),{response:r}=await tc.handle(e,{prefix:"/api/rpc",context:t});return r??new Response("Not Found",{status:404})}catch(t){let e=t instanceof Error?t.message:String(t);return console.error("[api/rpc] GET error:",t),Response.json({error:{code:"INTERNAL_SERVER_ERROR",message:e}},{status:500})}}async function tl(e){try{let t=await e0({request:e}),{response:r}=await tc.handle(e,{prefix:"/api/rpc",context:t});return r??new Response("Not Found",{status:404})}catch(t){let e=t instanceof Error?t.message:String(t);return console.error("[api/rpc] POST error:",t),Response.json({error:{code:"INTERNAL_SERVER_ERROR",message:e}},{status:500})}}e.s(["GET",()=>tu,"POST",()=>tl],69628);var td=e.i(69628);let tp=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/rpc/[[...path]]/route",pathname:"/api/rpc/[[...path]]",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/rpc/[[...path]]/route.ts",nextConfigOutput:"",userland:td}),{workAsyncStorage:th,workUnitAsyncStorage:tf,serverHooks:tm}=tp;function tg(){return(0,i.patchFetch)({workAsyncStorage:th,workUnitAsyncStorage:tf})}async function tw(e,t,r){tp.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/rpc/[[...path]]/route";n=n.replace(/\/index$/,"")||"/";let i=await tp.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:E,params:I,nextConfig:x,parsedUrl:R,isDraftMode:b,prerenderManifest:S,routerServerContext:O,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,resolvedPathname:A,clientReferenceManifest:C,serverActionsManifest:j}=i,N=(0,u.normalizeAppPath)(n),U=!!(S.dynamicRoutes[N]||S.routes[A]),z=async()=>((null==O?void 0:O.render404)?await O.render404(e,t,R,!1):t.end("This page could not be found"),null);if(U&&!b){let e=!!S.routes[A],t=S.dynamicRoutes[N];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await z();throw new y.NoFallbackError}}let P=null;!U||tp.isDev||b||(P="/index"===(P=A)?"/":P);let D=!0===tp.isDev||!U,M=U&&!D;j&&C&&(0,c.setManifestsSingleton)({page:n,clientReferenceManifest:C,serverActionsManifest:j});let V=e.method||"GET",L=(0,o.getTracer)(),$=L.getActiveScopeSpan(),k={params:I,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,a)=>tp.onRequestError(e,t,n,a,O)},sharedContext:{buildId:E}},q=new l.NodeNextRequest(e),F=new l.NodeNextResponse(t),H=d.NextRequestAdapter.fromNodeNextRequest(q,(0,d.signalFromNodeResponse)(t));try{let i=async e=>tp.handle(H,k).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${V} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${V} ${n}`)}),c=!!(0,s.getRequestMeta)(e,"minimalMode"),u=async s=>{var o,u;let l=async({previousCacheEntry:a})=>{try{if(!c&&T&&_&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(s);e.fetchMetrics=k.renderOpts.fetchMetrics;let o=k.renderOpts.pendingWaitUntil;o&&r.waitUntil&&(r.waitUntil(o),o=void 0);let u=k.renderOpts.collectedTags;if(!U)return await (0,f.sendResponse)(q,F,n,k.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[w.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==k.renderOpts.collectedRevalidate&&!(k.renderOpts.collectedRevalidate>=w.INFINITE_CACHE)&&k.renderOpts.collectedRevalidate,a=void 0===k.renderOpts.collectedExpire||k.renderOpts.collectedExpire>=w.INFINITE_CACHE?void 0:k.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await tp.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:T})},!1,O),t}},d=await tp.handleResponse({req:e,nextConfig:x,cacheKey:P,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,responseGenerator:l,waitUntil:r.waitUntil,isMinimalMode:c});if(!U)return null;if((null==d||null==(o=d.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(u=d.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});c||t.setHeader("x-nextjs-cache",T?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),b&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return c&&U||p.delete(w.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,f.sendResponse)(q,F,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};$?await u($):await L.withPropagatedContext(e.headers,()=>L.trace(p.BaseServerSpan.handleRequest,{spanName:`${V} ${n}`,kind:o.SpanKind.SERVER,attributes:{"http.method":V,"http.target":e.url}},u))}catch(t){if(t instanceof y.NoFallbackError||await tp.onRequestError(e,t,{routerKind:"App Router",routePath:N,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:T})},!1,O),U)throw t;return await (0,f.sendResponse)(q,F,new Response(null,{status:500})),null}}e.s(["handler",()=>tw,"patchFetch",()=>tg,"routeModule",()=>tp,"serverHooks",()=>tm,"workAsyncStorage",()=>th,"workUnitAsyncStorage",()=>tf],37235)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_9b31d8d6.js.map