module.exports=[53786,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(70025),f=a.i(33217),g=a.i(23292),h=a.i(16570),i=a.i(48964),j=a.i(68114);let k={slug:"",title:"",description:"",featuredImageUrl:"",published:!1,imageUrls:[]},l=/^[a-z0-9]+(?:-[a-z0-9]+)*$/;function m(a){return a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/[\s-]+/g,"-").replace(/^-+|-+$/g,"")}function n(a,b,c=[]){if("slug"===a){if(!b.trim())return"Slug is required";if(!l.test(b))return"Slug must be lowercase letters, numbers, and hyphens only";if(c.includes(b.trim().toLowerCase()))return"This slug is already used by another project."}if("title"===a&&!b.trim())return"Title is required"}let o="block text-xs font-semibold uppercase tracking-wider text-[var(--p-deep-walnut)]";function p(a){return(0,j.cn)("flex h-9 w-full border bg-[var(--p-white)] px-3 text-sm text-[var(--p-dark-walnut)] outline-none placeholder:text-[var(--p-coffee-bean)]/40 focus-visible:ring-1",a?"border-red-500 focus-visible:ring-red-400":"border-[var(--p-tan)] focus-visible:ring-[var(--p-toffee)]")}function q({message:a}){return a?(0,b.jsx)("p",{role:"alert",className:"mt-1 text-xs font-medium text-red-600",children:a}):null}function r({mode:a,id:j,initialData:l}){let r=(0,d.useRouter)(),[s,t]=(0,c.useState)(l??k),[u,v]=(0,c.useState)({}),w=(0,c.useRef)(!!l?.slug),x=(0,c.useRef)(null),{data:y}=(0,f.useQuery)({queryKey:["projects","admin"],queryFn:()=>h.client.project.listAdmin()}),z="create"===a?y?.map(a=>a.slug)??[]:y?.filter(a=>a.id!==j).map(a=>a.slug)??[],A=(0,e.useMutation)({mutationFn:a=>h.client.project.create(a),onSuccess:()=>{g.toast.success("Project created"),r.push("/cms/projects")},onError:a=>g.toast.error(a.message??"Failed to create")}),B=(0,e.useMutation)({mutationFn:a=>h.client.project.update(a),onSuccess:()=>{g.toast.success("Project updated"),r.push("/cms/projects")},onError:a=>g.toast.error(a.message??"Failed to update")}),C=A.isPending||B.isPending,D=(0,c.useCallback)(a=>{let b=n(a,s[a],z);v(c=>({...c,[a]:b}))},[s,z]);return(0,b.jsxs)("form",{onSubmit:function(b){b.preventDefault();let c=function(a,b=[]){let c={};for(let d of["slug","title"]){let e=n(d,a[d],b);e&&(c[d]=e)}return c}(s,z);if(v(c),Object.keys(c).length>0)return void requestAnimationFrame(()=>{x.current?.focus()});let d={slug:s.slug,title:s.title.trim(),description:s.description,featuredImageUrl:s.featuredImageUrl.trim()||null,published:s.published,imageUrls:s.imageUrls.filter(Boolean)};"create"===a?A.mutate(d):j&&B.mutate({id:j,...d})},className:"max-w-2xl space-y-6",noValidate:!0,children:[(0,b.jsxs)("fieldset",{className:"space-y-4 border border-[var(--p-tan)] bg-[var(--p-white)] p-6",children:[(0,b.jsx)("legend",{className:"px-2 text-xs font-semibold uppercase tracking-wider text-[var(--p-toffee)]",children:"Details"}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("label",{htmlFor:"title",className:o,children:["Title ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{id:"title",ref:a=>{u.title&&!u.slug&&(x.current=a)},className:p(!!u.title),value:s.title,onChange:function(a){let b=a.target.value;t(a=>({...a,title:b,slug:w.current?a.slug:m(b)})),u.title&&v(a=>({...a,title:void 0})),!w.current&&u.slug&&v(a=>({...a,slug:void 0}))},onBlur:()=>D("title"),placeholder:"Sharon Lane Kitchen"}),(0,b.jsx)(q,{message:u.title})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("label",{htmlFor:"slug",className:o,children:["Slug ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{id:"slug",ref:a=>{u.slug&&(x.current=a)},className:p(!!u.slug),value:s.slug,onChange:function(a){let b=a.target.value,c=m(b)||b.replace(/[^a-z0-9-]/gi,"").toLowerCase();w.current=!0,t(a=>({...a,slug:c})),u.slug&&v(a=>({...a,slug:void 0}))},onBlur:()=>D("slug"),placeholder:"sharon-lane-kitchen"}),(0,b.jsxs)("p",{className:"text-xs text-pretty text-[var(--p-coffee-bean)]/60",children:["Auto-generated from title. Lowercase, numbers, hyphens only — used in"," ",(0,b.jsx)("code",{className:"font-mono",children:"/projects/[slug]"}),"."]}),(0,b.jsx)(q,{message:u.slug})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("label",{htmlFor:"description",className:o,children:"Description (Markdown)"}),(0,b.jsx)("textarea",{id:"description",className:"flex min-h-40 w-full border border-[var(--p-tan)] bg-[var(--p-white)] px-3 py-2 text-sm text-[var(--p-dark-walnut)] outline-none placeholder:text-[var(--p-coffee-bean)]/40 focus-visible:ring-1 focus-visible:ring-[var(--p-toffee)]",value:s.description,onChange:a=>t(b=>({...b,description:a.target.value}))})]})]}),(0,b.jsxs)("fieldset",{className:"space-y-4 border border-[var(--p-tan)] bg-[var(--p-white)] p-6",children:[(0,b.jsx)("legend",{className:"px-2 text-xs font-semibold uppercase tracking-wider text-[var(--p-toffee)]",children:"Featured image"}),(0,b.jsx)("p",{className:"text-xs text-[var(--p-coffee-bean)]/60",children:"The main image shown on the project card and hero. Upload one or paste a URL."}),(0,b.jsx)(i.ImageUploader,{multiple:!1,value:s.featuredImageUrl?[s.featuredImageUrl]:[],onChange:a=>{t(b=>({...b,featuredImageUrl:a[0]??""})),v(a=>({...a,featuredImageUrl:void 0}))},disabled:C}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{htmlFor:"featured-url",className:o,children:"Or paste URL"}),(0,b.jsx)("input",{id:"featured-url",ref:a=>{!u.featuredImageUrl||u.slug||u.title||(x.current=a)},className:p(!!u.featuredImageUrl),value:s.featuredImageUrl,onChange:a=>{t(b=>({...b,featuredImageUrl:a.target.value})),u.featuredImageUrl&&v(a=>({...a,featuredImageUrl:void 0}))},onBlur:()=>D("featuredImageUrl"),placeholder:"https://..."}),(0,b.jsx)(q,{message:u.featuredImageUrl})]})]}),(0,b.jsxs)("fieldset",{className:"space-y-4 border border-[var(--p-tan)] bg-[var(--p-white)] p-6",children:[(0,b.jsx)("legend",{className:"px-2 text-xs font-semibold uppercase tracking-wider text-[var(--p-toffee)]",children:"Gallery images"}),(0,b.jsx)("p",{className:"text-xs text-[var(--p-coffee-bean)]/60",children:"Shown in the carousel on the project page. Select multiple files at once or drag & drop."}),(0,b.jsx)(i.ImageUploader,{multiple:!0,value:s.imageUrls,onChange:a=>t(b=>({...b,imageUrls:a})),disabled:C})]}),(0,b.jsxs)("fieldset",{className:"space-y-4 border border-[var(--p-tan)] bg-[var(--p-white)] p-6",children:[(0,b.jsx)("legend",{className:"px-2 text-xs font-semibold uppercase tracking-wider text-[var(--p-toffee)]",children:"Publishing"}),(0,b.jsxs)("label",{className:"flex cursor-pointer items-center gap-3",children:[(0,b.jsx)("input",{type:"checkbox",checked:s.published,onChange:a=>t(b=>({...b,published:a.target.checked})),className:"size-4 accent-[var(--p-deep-walnut)]"}),(0,b.jsx)("span",{className:"text-sm text-[var(--p-dark-walnut)]",children:"Published — visible on the public site"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{type:"submit",className:"inline-flex h-9 items-center justify-center border-2 border-[var(--p-deep-walnut)] bg-[var(--p-deep-walnut)] px-5 text-xs font-semibold text-[var(--p-white)] outline-none transition-opacity hover:opacity-90 focus-visible:ring-2 focus-visible:ring-[var(--p-deep-walnut)] focus-visible:ring-offset-2 disabled:opacity-50",disabled:C,children:"create"===a?"Create project":"Save changes"}),(0,b.jsx)("button",{type:"button",className:"inline-flex h-9 items-center justify-center border-2 border-[var(--p-tan)] bg-transparent px-5 text-xs font-semibold text-[var(--p-coffee-bean)] outline-none transition-opacity hover:opacity-80 focus-visible:ring-2 focus-visible:ring-[var(--p-toffee)] focus-visible:ring-offset-2",onClick:()=>r.push("/cms/projects"),children:"Cancel"})]})]})}a.s(["ProjectForm",()=>r])}];

//# sourceMappingURL=src_app_cms_projects_project-form_tsx_7e23e467._.js.map