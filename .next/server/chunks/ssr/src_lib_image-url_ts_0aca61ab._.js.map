{"version":3,"sources":["../../../../src/lib/image-url.ts"],"sourcesContent":["/**\n * Use the same-origin image proxy only for R2 URLs to avoid CORS.\n * Same-origin, relative, and other URLs (e.g. Google avatars) are returned unchanged.\n * Invalid URLs are returned as-is so the browser can fail gracefully instead of throwing.\n */\nconst R2_PUBLIC_RE = /^https:\\/\\/[a-zA-Z0-9.-]+\\.r2\\.dev(\\/|$)/;\n\nfunction isConstructableUrl(url: string): boolean {\n  if (url.startsWith(\"/\")) return true;\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport function proxyImageUrlIfNeeded(url: string): string {\n  if (!url || url.startsWith(\"/\")) return url;\n  if (!isConstructableUrl(url)) return url;\n  if (R2_PUBLIC_RE.test(url)) {\n    return `/api/image?url=${encodeURIComponent(url)}`;\n  }\n  return url;\n}\n"],"names":[],"mappings":"uCAKA,IAAM,EAAe,2CAYd,SAAS,EAAsB,CAAW,QAC/C,AAAI,CAAC,GAAO,EAAI,UAAU,CAAC,MAAM,AAC7B,CAAC,AAZP,SAAS,AAAmB,CAAW,EACrC,GAAI,EAAI,UAAU,CAAC,KAAM,OAAO,EAChC,GAAI,CAEF,OADA,IAAI,IAAI,IACD,CACT,CAAE,KAAM,CACN,OAAO,CACT,CACF,EAI0B,GADgB,EAEpC,CAD0B,CACb,IAAI,CAAC,CADe,EAE5B,CAAC,EADkB,aACH,EAAE,mBAAmB,GAAA,CAAM,CAE7C,CACT"}